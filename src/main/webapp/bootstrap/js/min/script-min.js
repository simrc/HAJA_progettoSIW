function mettiNelCarrello(){$(".acquista").on("click",function(){var t=JSON.parse(localStorage.getItem("order"));null===t&&(t={}),void 0!==t[$(this).data("id")]?t[$(this).data("id")].quantity>=$(this).data("quantity")?alert("Non abbiamo abbastanza "+$(this).data("name")+" in magazzino."):t[$(this).data("id")].quantity++:t[$(this).data("id")]={id:$(this).data("id"),name:$(this).data("name"),description:$(this).data("description"),price:$(this).data("price"),quantity:1},t=JSON.stringify(t),localStorage.setItem("order",t),refreshCart()})}function refreshCart(){var t=JSON.parse(localStorage.getItem("order"));$("#currentCart").html("");var r=0;for(product in t)orderLine=t[product],$("#currentCart").append("<li><h4><a href='#'>"+orderLine.name+"</a><span class='quantity'>("+orderLine.quantity+")</span><span class='price'>&euro; "+orderLine.quantity*orderLine.price+"</span></h4><p class='desc'>"+orderLine.description+"</p></li>"),r+=orderLine.price*orderLine.quantity;$("#totalCart").html("TOT: &euro; "+r)}function svuotaCarrello(){localStorage.removeItem("order"),refreshCart()}$(function(){$("#main-nav, #secondary-nav").find('a[href="'+location.pathname+'"]').addClass("active")}),refreshCart(),$("#confermaOrdine").on("click",function(){var t={creationDate:new Date,orderLines:[]},r=JSON.parse(localStorage.getItem("order"));for(product in r)t.orderLines.push({product:{id:r[product].id},quantity:r[product].quantity,price:r[product].price});localStorage.setItem("json",JSON.stringify(t)),$.ajax({type:"POST",url:"/customer/order",data:{json:localStorage.getItem("json")},success:function(){svuotaCarrello(),alert("Ordine confermato correttamente.")}})}),$(document).ready(function(){refreshCart(),mettiNelCarrello(),$("#svuotaCarrello").on("click",function(){svuotaCarrello()})});